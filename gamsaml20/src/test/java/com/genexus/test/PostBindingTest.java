package com.genexus.test;

import com.genexus.saml20.PostBinding;
import com.genexus.saml20.SamlParms;
import org.bouncycastle.util.encoders.Base64;
import org.junit.Assert;
import org.junit.BeforeClass;
import org.junit.Test;

import java.nio.charset.StandardCharsets;

public class PostBindingTest {

	public static final String resources = System.getProperty("user.dir").concat("/src/test/resources");

	private static PostBinding postBindingLoginResponse;
	private static PostBinding postBindingLogoutResponse;
	private static String alias;
	private static String password;

	@BeforeClass
	public static void setUp() {
		postBindingLoginResponse = new PostBinding();
		String b64Login = "PHNhbWxwOlJlc3BvbnNlIHhtbG5zOnNhbWxwPSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6cHJvdG9jb2wiIHhtbG5zOnNhbWw9InVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDphc3NlcnRpb24iIElEPSJfOGU4ZGM1ZjY5YTk4Y2M0YzFmZjM0MjdlNWNlMzQ2MDZmZDY3MmY5MWU2IiBWZXJzaW9uPSIyLjAiIElzc3VlSW5zdGFudD0iMjAxNC0wNy0xN1QwMTowMTo0OFoiIERlc3RpbmF0aW9uPSJodHRwOi8vc3AuZXhhbXBsZS5jb20vZGVtbzEvaW5kZXgucGhwP2FjcyIgSW5SZXNwb25zZVRvPSJPTkVMT0dJTl80ZmVlM2IwNDYzOTVjNGU3NTEwMTFlOTdmODkwMGI1MjczZDU2Njg1Ij4KICA8c2FtbDpJc3N1ZXI+aHR0cDovL2lkcC5leGFtcGxlLmNvbS9tZXRhZGF0YS5waHA8L3NhbWw6SXNzdWVyPgogIDxzYW1scDpTdGF0dXM+CiAgICA8c2FtbHA6U3RhdHVzQ29kZSBWYWx1ZT0idXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOnN0YXR1czpTdWNjZXNzIiAvPgogIDwvc2FtbHA6U3RhdHVzPgogIDxzYW1sOkFzc2VydGlvbiB4bWxuczp4c2k9Imh0dHA6Ly93d3cudzMub3JnLzIwMDEvWE1MU2NoZW1hLWluc3RhbmNlIiB4bWxuczp4cz0iaHR0cDovL3d3dy53My5vcmcvMjAwMS9YTUxTY2hlbWEiIElEPSJfZDcxYTNhOGU5ZmNjNDVjOWU5ZDI0OGVmNzA0OTM5M2ZjOGYwNGU1Zjc1IiBWZXJzaW9uPSIyLjAiIElzc3VlSW5zdGFudD0iMjAxNC0wNy0xN1QwMTowMTo0OFoiPgogICAgPHNhbWw6SXNzdWVyPmh0dHA6Ly9pZHAuZXhhbXBsZS5jb20vbWV0YWRhdGEucGhwPC9zYW1sOklzc3Vlcj4KICAgIDxzYW1sOlN1YmplY3Q+CiAgICAgIDxzYW1sOk5hbWVJRCBTUE5hbWVRdWFsaWZpZXI9Imh0dHA6Ly9zcC5leGFtcGxlLmNvbS9kZW1vMS9tZXRhZGF0YS5waHAiIEZvcm1hdD0idXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOm5hbWVpZC1mb3JtYXQ6dHJhbnNpZW50Ij5fY2UzZDI5NDhiNGNmMjAxNDZkZWUwYTBiM2RkNmY2OWI2Y2Y4NmY2MmQ3PC9zYW1sOk5hbWVJRD4KICAgICAgPHNhbWw6U3ViamVjdENvbmZpcm1hdGlvbiBNZXRob2Q9InVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDpjbTpiZWFyZXIiPgogICAgICAgIDxzYW1sOlN1YmplY3RDb25maXJtYXRpb25EYXRhIE5vdE9uT3JBZnRlcj0iMjAyNC0wMS0xOFQwNjoyMTo0OFoiIFJlY2lwaWVudD0iaHR0cDovL3NwLmV4YW1wbGUuY29tL2RlbW8xL2luZGV4LnBocD9hY3MiIEluUmVzcG9uc2VUbz0iT05FTE9HSU5fNGZlZTNiMDQ2Mzk1YzRlNzUxMDExZTk3Zjg5MDBiNTI3M2Q1NjY4NSIgLz4KICAgICAgPC9zYW1sOlN1YmplY3RDb25maXJtYXRpb24+CiAgICA8L3NhbWw6U3ViamVjdD4KICAgIDxzYW1sOkNvbmRpdGlvbnMgTm90QmVmb3JlPSIyMDE0LTA3LTE3VDAxOjAxOjE4WiIgTm90T25PckFmdGVyPSIyMDI0LTAxLTE4VDA2OjIxOjQ4WiI+CiAgICAgIDxzYW1sOkF1ZGllbmNlUmVzdHJpY3Rpb24+CiAgICAgICAgPHNhbWw6QXVkaWVuY2U+aHR0cDovL3NwLmV4YW1wbGUuY29tL2RlbW8xL21ldGFkYXRhLnBocDwvc2FtbDpBdWRpZW5jZT4KICAgICAgPC9zYW1sOkF1ZGllbmNlUmVzdHJpY3Rpb24+CiAgICA8L3NhbWw6Q29uZGl0aW9ucz4KICAgIDxzYW1sOkF1dGhuU3RhdGVtZW50IEF1dGhuSW5zdGFudD0iMjAxNC0wNy0xN1QwMTowMTo0OFoiIFNlc3Npb25Ob3RPbk9yQWZ0ZXI9IjIwMjQtMDctMTdUMDk6MDE6NDhaIiBTZXNzaW9uSW5kZXg9Il9iZTk5NjdhYmQ5MDRkZGNhZTNjMGViNDE4OWFkYmUzZjcxZTMyN2NmOTMiPgogICAgICA8c2FtbDpBdXRobkNvbnRleHQ+CiAgICAgICAgPHNhbWw6QXV0aG5Db250ZXh0Q2xhc3NSZWY+dXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOmFjOmNsYXNzZXM6UGFzc3dvcmQ8L3NhbWw6QXV0aG5Db250ZXh0Q2xhc3NSZWY+CiAgICAgIDwvc2FtbDpBdXRobkNvbnRleHQ+CiAgICA8L3NhbWw6QXV0aG5TdGF0ZW1lbnQ+CiAgICA8c2FtbDpBdHRyaWJ1dGVTdGF0ZW1lbnQ+CiAgICAgIDxzYW1sOkF0dHJpYnV0ZSBOYW1lPSJ1aWQiIE5hbWVGb3JtYXQ9InVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDphdHRybmFtZS1mb3JtYXQ6YmFzaWMiPgogICAgICAgIDxzYW1sOkF0dHJpYnV0ZVZhbHVlIHhzaTp0eXBlPSJ4czpzdHJpbmciPnRlc3Q8L3NhbWw6QXR0cmlidXRlVmFsdWU+CiAgICAgIDwvc2FtbDpBdHRyaWJ1dGU+CiAgICAgIDxzYW1sOkF0dHJpYnV0ZSBOYW1lPSJtYWlsIiBOYW1lRm9ybWF0PSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6YXR0cm5hbWUtZm9ybWF0OmJhc2ljIj4KICAgICAgICA8c2FtbDpBdHRyaWJ1dGVWYWx1ZSB4c2k6dHlwZT0ieHM6c3RyaW5nIj50ZXN0QGV4YW1wbGUuY29tPC9zYW1sOkF0dHJpYnV0ZVZhbHVlPgogICAgICA8L3NhbWw6QXR0cmlidXRlPgogICAgICA8c2FtbDpBdHRyaWJ1dGUgTmFtZT0iZWR1UGVyc29uQWZmaWxpYXRpb24iIE5hbWVGb3JtYXQ9InVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDphdHRybmFtZS1mb3JtYXQ6YmFzaWMiPgogICAgICAgIDxzYW1sOkF0dHJpYnV0ZVZhbHVlIHhzaTp0eXBlPSJ4czpzdHJpbmciPnVzZXJzPC9zYW1sOkF0dHJpYnV0ZVZhbHVlPgogICAgICAgIDxzYW1sOkF0dHJpYnV0ZVZhbHVlIHhzaTp0eXBlPSJ4czpzdHJpbmciPmV4YW1wbGVyb2xlMTwvc2FtbDpBdHRyaWJ1dGVWYWx1ZT4KICAgICAgPC9zYW1sOkF0dHJpYnV0ZT4KICAgIDwvc2FtbDpBdHRyaWJ1dGVTdGF0ZW1lbnQ+CiAgPFNpZ25hdHVyZSB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC8wOS94bWxkc2lnIyI+PFNpZ25lZEluZm8+PENhbm9uaWNhbGl6YXRpb25NZXRob2QgQWxnb3JpdGhtPSJodHRwOi8vd3d3LnczLm9yZy9UUi8yMDAxL1JFQy14bWwtYzE0bi0yMDAxMDMxNSIgLz48U2lnbmF0dXJlTWV0aG9kIEFsZ29yaXRobT0iaHR0cDovL3d3dy53My5vcmcvMjAwMS8wNC94bWxkc2lnLW1vcmUjcnNhLXNoYTI1NiIgLz48UmVmZXJlbmNlIFVSST0iI19kNzFhM2E4ZTlmY2M0NWM5ZTlkMjQ4ZWY3MDQ5MzkzZmM4ZjA0ZTVmNzUiPjxUcmFuc2Zvcm1zPjxUcmFuc2Zvcm0gQWxnb3JpdGhtPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwLzA5L3htbGRzaWcjZW52ZWxvcGVkLXNpZ25hdHVyZSIgLz48L1RyYW5zZm9ybXM+PERpZ2VzdE1ldGhvZCBBbGdvcml0aG09Imh0dHA6Ly93d3cudzMub3JnLzIwMDEvMDQveG1sZW5jI3NoYTI1NiIgLz48RGlnZXN0VmFsdWU+dWNwMm1qT2ZCNDZaaWxHbFpKUzhWR0VMVWpRZ0xQdnl3d3hIVjJHdjNmdz08L0RpZ2VzdFZhbHVlPjwvUmVmZXJlbmNlPjwvU2lnbmVkSW5mbz48U2lnbmF0dXJlVmFsdWU+cUdSWExNVHF4dHRqWldrWkovOEo5MWZkTVNSa2NZbW9DUTVhaFhGYUk5QzNobmlyQ0lUVjNIM1M1VDRiQTg0RC9tRVcyZDkwNmZ6ZnVhZWR1TnJRMkU1U0VtTUFFV25EdEwyak9GTzBrSGlZMHdoS2s4TkZSRnc2eC9kVk5uVUxQOXhnOGN5cmV6dVNxY1VSd1RWKzlhMXI4NGQ2VlpoLzJLTTg3WUMrODh2RVN2QXBUTXdmMGI2RUdmb3FvbDlJNG9KMDcrME9KMEdyU3VFajExTU1hTkZNakhTYmVKOXpGaWluV0lPSUVRdW9XRWVrUHhLNzQxTzJyMTNyNm5PbnVSajIwdThuVmRLb2tncGR2L1VwL0VtOVNGUVFsVDN5TUFhY0JlbjhPL1ZLOTF3TjdMbTQvZkpkWjF1UTFHOHVrcTRLSHZZWGc3K3VyKzJHbHVYY2JRPT08L1NpZ25hdHVyZVZhbHVlPjxLZXlJbmZvPjxYNTA5RGF0YT48WDUwOUNlcnRpZmljYXRlPk1JSUVBVENDQXVtZ0F3SUJBZ0lKQUlBcXZLSForZ0ZoTUEwR0NTcUdTSWIzRFFFQkN3VUFNSUdXTVFzd0NRWURWUVFHRXdKVldURVRNQkVHQTFVRUNBd0tUVzl1ZEdWMmFXUmxiekVUTUJFR0ExVUVCd3dLVFc5dWRHVjJhV1JsYnpFUU1BNEdBMVVFQ2d3SFIyVnVaVmgxY3pFUk1BOEdBMVVFQ3d3SVUyVmpkWEpwZEhreEVqQVFCZ05WQkFNTUNYTm5jbUZ0Y0c5dVpURWtNQ0lHQ1NxR1NJYjNEUUVKQVJZVmMyZHlZVzF3YjI1bFFHZGxibVY0ZFhNdVkyOXRNQjRYRFRJd01EY3dPREU0TlRjeE4xb1hEVEkxTURjd056RTROVGN4TjFvd2daWXhDekFKQmdOVkJBWVRBbFZaTVJNd0VRWURWUVFJREFwTmIyNTBaWFpwWkdWdk1STXdFUVlEVlFRSERBcE5iMjUwWlhacFpHVnZNUkF3RGdZRFZRUUtEQWRIWlc1bFdIVnpNUkV3RHdZRFZRUUxEQWhUWldOMWNtbDBlVEVTTUJBR0ExVUVBd3dKYzJkeVlXMXdiMjVsTVNRd0lnWUpLb1pJaHZjTkFRa0JGaFZ6WjNKaGJYQnZibVZBWjJWdVpYaDFjeTVqYjIwd2dnRWlNQTBHQ1NxR1NJYjNEUUVCQVFVQUE0SUJEd0F3Z2dFS0FvSUJBUUMxemdhVStXaDYzcDlETldvQXk2NDI1MkV2WmpONDlBWTN4MFFDbkFhOEpPOVBrN3puUXdyeEVGVUtnWnp2MEdIRVlXNytYK3V5SnI3Qlc0VEE2ZnVKSjhhZ0UvYm1aUlp5amRKam91ZTBGTUw2ZmJtQ1o5VHN4cHhlNHB6aXNweVdROGpZVDRLbDRJM2ZkWk5VU240WFNpZG5ES0JJU2VDMDVtcmNjaERLaElucGlZREo0ODFsc0I0SlRFdGkzUzRYeS9Ub0t3WTR0NmF0dHc2ejVRRGhCYytZcm8rWVVxcnVsaU9BS3FjZnliZTlrMDdqd01DdkZWTTFocllZSjdod0hEU0ZvM01Ld1oweTJndzB3NlNnVkJ4TEZvK0tZUDNxNjNiNXdWaEQ4bHphU2grOFVjeWlITTIveWpFZWo3RW5SRnpkY2xUU05YUkZOYWlMbkVWZEFnTUJBQUdqVURCT01CMEdBMVVkRGdRV0JCUXRRQVdKUldOci9Pc3dQU0Fkd0NRaDBFZWkvREFmQmdOVkhTTUVHREFXZ0JRdFFBV0pSV05yL09zd1BTQWR3Q1FoMEVlaS9EQU1CZ05WSFJNRUJUQURBUUgvTUEwR0NTcUdTSWIzRFFFQkN3VUFBNElCQVFDakhlM0piTkt2MFl3YzF6bExhY1VOV2NqTGJtenZuanM4V3E1b3h0ZjV3RzVQVWxoTFNZWjlNUGh1Zjk1UGxpYm5yTy94VlkyOTJQNWxvNE5LaFM3Vk9vbnBiUFEvUHJDTU84NFB6MUxHZk0vd0NXUUlvd2g2VkhxMThQaVprYTl6YndsNlNvMHRnQ2xLa0ZTUms0d3BLcldYMytNMytZK0QwYnJkOHNFdEE2ZFhlWUhEdHFWMFlnaktkWklJT3gwdkRUNGFsQ29WUXJRMXlBSXE1SU5UM2NTTGdKZXpJaEVhZER2M1RjN2JNeE1GZUwrODFxSG05Wi85L0tFNlorSkIwWkVPa0YvMk5TUUpkK1o3TUJSOEN4T2RUUWlzM2x0TW9YRGF0TmtqWjJFbnY0MHN3NE5JQ0I4WVloc1dNSWFyZXc1dU5UK1JTMjhZSE5sYm1vZ2g8L1g1MDlDZXJ0aWZpY2F0ZT48L1g1MDlEYXRhPjwvS2V5SW5mbz48L1NpZ25hdHVyZT48L3NhbWw6QXNzZXJ0aW9uPgo8L3NhbWxwOlJlc3BvbnNlPg==";
		postBindingLoginResponse.init(new String(Base64.decode(b64Login), StandardCharsets.UTF_8));

		postBindingLogoutResponse = new PostBinding();
		String b64Logout = "PHNhbWxwOkxvZ291dFJlc3BvbnNlIHhtbG5zOnNhbWxwPSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6cHJvdG9jb2wiIHhtbG5zOnNhbWw9InVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDphc3NlcnRpb24iIElEPSJfNmMzNzM3MjgyZjAwNzcyMGU3MzZmMGY0MDI4ZmVlZDhjYjliNDAyOTFjIiBWZXJzaW9uPSIyLjAiIElzc3VlSW5zdGFudD0iMjAxNC0wNy0xOFQwMToxMzowNloiIERlc3RpbmF0aW9uPSJodHRwOi8vc3AuZXhhbXBsZS5jb20vZGVtbzEvaW5kZXgucGhwP2FjcyIgSW5SZXNwb25zZVRvPSJPTkVMT0dJTl8yMWRmOTFhODk3Njc4NzlmYzBmN2RmNmExNDkwYzYwMDBjODE2NDRkIj4NCiAgPHNhbWw6SXNzdWVyPmh0dHA6Ly9pZHAuZXhhbXBsZS5jb20vbWV0YWRhdGEucGhwPC9zYW1sOklzc3Vlcj4NCiAgPHNhbWxwOlN0YXR1cz4NCiAgICA8c2FtbHA6U3RhdHVzQ29kZSBWYWx1ZT0idXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOnN0YXR1czpTdWNjZXNzIiAvPg0KICA8L3NhbWxwOlN0YXR1cz4NCjxTaWduYXR1cmUgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvMDkveG1sZHNpZyMiPjxTaWduZWRJbmZvPjxDYW5vbmljYWxpemF0aW9uTWV0aG9kIEFsZ29yaXRobT0iaHR0cDovL3d3dy53My5vcmcvVFIvMjAwMS9SRUMteG1sLWMxNG4tMjAwMTAzMTUiIC8+PFNpZ25hdHVyZU1ldGhvZCBBbGdvcml0aG09Imh0dHA6Ly93d3cudzMub3JnLzIwMDEvMDQveG1sZHNpZy1tb3JlI3JzYS1zaGEyNTYiIC8+PFJlZmVyZW5jZSBVUkk9IiNfNmMzNzM3MjgyZjAwNzcyMGU3MzZmMGY0MDI4ZmVlZDhjYjliNDAyOTFjIj48VHJhbnNmb3Jtcz48VHJhbnNmb3JtIEFsZ29yaXRobT0iaHR0cDovL3d3dy53My5vcmcvMjAwMC8wOS94bWxkc2lnI2VudmVsb3BlZC1zaWduYXR1cmUiIC8+PC9UcmFuc2Zvcm1zPjxEaWdlc3RNZXRob2QgQWxnb3JpdGhtPSJodHRwOi8vd3d3LnczLm9yZy8yMDAxLzA0L3htbGVuYyNzaGEyNTYiIC8+PERpZ2VzdFZhbHVlPlYwdDFxcVQzaENuNVJsYmFqWU5Va21wYUxpRzhsVXRobWx4aW1vMzJ5dEk9PC9EaWdlc3RWYWx1ZT48L1JlZmVyZW5jZT48L1NpZ25lZEluZm8+PFNpZ25hdHVyZVZhbHVlPkJId2ZzS3lzSXZFMlh3ajdiVDVlRzBIVER5NXFrK25jUjRGQmlsZDI3d3dnWG9UTDdnMXZ1bDVsNCtIeU9QeUZMMXdmbC9DTWR4SE9pNDBLcytOTXJWcUpKRkRDT1NqdGJDWGdHQTg2ZzV1KzRjM2ZRNlNSckxMbUJZa0JSdjlGeGRCVzdTbEhGM2hiall2azFLVXNRV1llTVR5bW00UERHSCtuNGtsbmdFcklrWDBvSHZHcUJDZmt0bGdWTmwvanpHcWNoUnk1Tnpta2lrZGd5bGNJUUZjNS9hUWlEYXE0ODMrZVBhVjIrVHdKNWlBeFRrRXFsVHBLMGVZcjNILzkwRXpid1BaL0F0TjB1RGk4YkdZYmVBeUszR3oyVWFKUEpVWHpzM1dMWDc4UTN1a3hIM0FxaUpHM21PZUIvclBDeDdSeVBrZEZNS2xPeHVkTWM5NDBkdz09PC9TaWduYXR1cmVWYWx1ZT48S2V5SW5mbz48WDUwOURhdGE+PFg1MDlDZXJ0aWZpY2F0ZT5NSUlFQVRDQ0F1bWdBd0lCQWdJSkFJQXF2S0haK2dGaE1BMEdDU3FHU0liM0RRRUJDd1VBTUlHV01Rc3dDUVlEVlFRR0V3SlZXVEVUTUJFR0ExVUVDQXdLVFc5dWRHVjJhV1JsYnpFVE1CRUdBMVVFQnd3S1RXOXVkR1YyYVdSbGJ6RVFNQTRHQTFVRUNnd0hSMlZ1WlZoMWN6RVJNQThHQTFVRUN3d0lVMlZqZFhKcGRIa3hFakFRQmdOVkJBTU1DWE5uY21GdGNHOXVaVEVrTUNJR0NTcUdTSWIzRFFFSkFSWVZjMmR5WVcxd2IyNWxRR2RsYm1WNGRYTXVZMjl0TUI0WERUSXdNRGN3T0RFNE5UY3hOMW9YRFRJMU1EY3dOekU0TlRjeE4xb3dnWll4Q3pBSkJnTlZCQVlUQWxWWk1STXdFUVlEVlFRSURBcE5iMjUwWlhacFpHVnZNUk13RVFZRFZRUUhEQXBOYjI1MFpYWnBaR1Z2TVJBd0RnWURWUVFLREFkSFpXNWxXSFZ6TVJFd0R3WURWUVFMREFoVFpXTjFjbWwwZVRFU01CQUdBMVVFQXd3SmMyZHlZVzF3YjI1bE1TUXdJZ1lKS29aSWh2Y05BUWtCRmhWelozSmhiWEJ2Ym1WQVoyVnVaWGgxY3k1amIyMHdnZ0VpTUEwR0NTcUdTSWIzRFFFQkFRVUFBNElCRHdBd2dnRUtBb0lCQVFDMXpnYVUrV2g2M3A5RE5Xb0F5NjQyNTJFdlpqTjQ5QVkzeDBRQ25BYThKTzlQazd6blF3cnhFRlVLZ1p6djBHSEVZVzcrWCt1eUpyN0JXNFRBNmZ1Sko4YWdFL2JtWlJaeWpkSmpvdWUwRk1MNmZibUNaOVRzeHB4ZTRwemlzcHlXUThqWVQ0S2w0STNmZFpOVVNuNFhTaWRuREtCSVNlQzA1bXJjY2hES2hJbnBpWURKNDgxbHNCNEpURXRpM1M0WHkvVG9Ld1k0dDZhdHR3Nno1UURoQmMrWXJvK1lVcXJ1bGlPQUtxY2Z5YmU5azA3andNQ3ZGVk0xaHJZWUo3aHdIRFNGbzNNS3daMHkyZ3cwdzZTZ1ZCeExGbytLWVAzcTYzYjV3VmhEOGx6YVNoKzhVY3lpSE0yL3lqRWVqN0VuUkZ6ZGNsVFNOWFJGTmFpTG5FVmRBZ01CQUFHalVEQk9NQjBHQTFVZERnUVdCQlF0UUFXSlJXTnIvT3N3UFNBZHdDUWgwRWVpL0RBZkJnTlZIU01FR0RBV2dCUXRRQVdKUldOci9Pc3dQU0Fkd0NRaDBFZWkvREFNQmdOVkhSTUVCVEFEQVFIL01BMEdDU3FHU0liM0RRRUJDd1VBQTRJQkFRQ2pIZTNKYk5LdjBZd2MxemxMYWNVTldjakxibXp2bmpzOFdxNW94dGY1d0c1UFVsaExTWVo5TVBodWY5NVBsaWJuck8veFZZMjkyUDVsbzROS2hTN1ZPb25wYlBRL1ByQ01PODRQejFMR2ZNL3dDV1FJb3doNlZIcTE4UGlaa2E5emJ3bDZTbzB0Z0NsS2tGU1JrNHdwS3JXWDMrTTMrWStEMGJyZDhzRXRBNmRYZVlIRHRxVjBZZ2pLZFpJSU94MHZEVDRhbENvVlFyUTF5QUlxNUlOVDNjU0xnSmV6SWhFYWREdjNUYzdiTXhNRmVMKzgxcUhtOVovOS9LRTZaK0pCMFpFT2tGLzJOU1FKZCtaN01CUjhDeE9kVFFpczNsdE1vWERhdE5raloyRW52NDBzdzROSUNCOFlZaHNXTUlhcmV3NXVOVCtSUzI4WUhObGJtb2doPC9YNTA5Q2VydGlmaWNhdGU+PC9YNTA5RGF0YT48L0tleUluZm8+PC9TaWduYXR1cmU+PC9zYW1scDpMb2dvdXRSZXNwb25zZT4=";
		postBindingLogoutResponse.init(new String(Base64.decode(b64Logout), StandardCharsets.UTF_8));
		alias = "1";
		password = "dummy1";
	}

	@Test
	public void testSignatureValidation_true() {
		SamlParms parms = new SamlParms();
		parms.setTrustCertPath(resources.concat("/keystore.jks"));
		parms.setTrustCertAlias(alias);
		parms.setTrustCertPass(password);
		Assert.assertTrue("testSignatureValidation_true Login", postBindingLoginResponse.verifySignatures(parms));
		Assert.assertTrue("testSignatureValidation_true Logout", postBindingLogoutResponse.verifySignatures(parms));
	}

	@Test
	public void testSignatureValidation_false() {
		SamlParms parms = new SamlParms();
		parms.setTrustCertPath(resources.concat("/mykeystore.jks"));
		parms.setTrustCertAlias(alias);
		parms.setTrustCertPass(password);
		Assert.assertFalse("testSignatureValidation_false Login", postBindingLoginResponse.verifySignatures(parms));
		Assert.assertFalse("testSignatureValidation_false Logout", postBindingLogoutResponse.verifySignatures(parms));
	}

	@Test
	public void testIsLogout() {
		Assert.assertFalse("testIsLogout Login", postBindingLoginResponse.isLogout());
		Assert.assertTrue("testIsLogout Logout", postBindingLogoutResponse.isLogout());
	}

	@Test
	public void testGetLoginAssertions() {
		String expected = "{\"InResponseTo\": \"ONELOGIN_4fee3b046395c4e751011e97f8900b5273d56685\",\"NotOnOrAfter\": \"2024-01-18T06:21:48Z\",\"NotBefore\": \"2014-07-17T01:01:18Z\",\"Recipient\": \"http://sp.example.com/demo1/index.php?acs\",\"SessionIndex\": \"_be9967abd904ddcae3c0eb4189adbe3f71e327cf93\",\"Destination\": \"http://sp.example.com/demo1/index.php?acs\",\"Value\": \"urn:oasis:names:tc:SAML:2.0:status:Success\",\"Issuer\": \"http://idp.example.com/metadata.php\",\"Audience\": \"http://sp.example.com/demo1/metadata.php\",\"NameID\": \"_ce3d2948b4cf20146dee0a0b3dd6f69b6cf86f62d7\" }";
		Assert.assertEquals(expected, postBindingLoginResponse.getLoginAssertions());
	}

	@Test
	public void testGetLogoutAssertions() {
		String expected = "{\"Destination\": \"http://sp.example.com/demo1/index.php?acs\",\"InResponseTo\": \"ONELOGIN_21df91a89767879fc0f7df6a1490c6000c81644d\",\"Value\": \"urn:oasis:names:tc:SAML:2.0:status:Success\",\"Issuer\": \"http://idp.example.com/metadata.php\" }";
		Assert.assertEquals(expected, postBindingLogoutResponse.getLogoutAssertions());
	}

	@Test
	public void testGetRoles() {
		String expected = "users,examplerole1";
		Assert.assertEquals(expected, postBindingLoginResponse.getRoles("eduPersonAffiliation"));
	}

	@Test
	public void testGetLoginAttribute() {
		String expected = "test@example.com";
		Assert.assertEquals(expected, postBindingLoginResponse.getLoginAttribute("mail"));
	}

}
