# GeneXus Observability

A Java library for integrating OpenTelemetry tracing capabilities into GeneXus applications.

## Overview

The GeneXus Observability module provides a wrapper around the OpenTelemetry Java SDK, allowing GeneXus applications to easily implement distributed tracing. It simplifies the process of creating spans, managing trace context, and propagating trace information across service boundaries.

## Features

- Creation and management of spans with different configurations
- Context propagation across service boundaries
- Ability to add and retrieve baggage items (metadata associated with a trace)
- Support for different span types (internal, server, client, producer, consumer)
- Ability to set span attributes, status, and record exceptions
- Automatic configuration from environment variables

## Dependencies

This module depends on the following OpenTelemetry components:

- opentelemetry-api
- opentelemetry-sdk-trace
- opentelemetry-exporter-otlp
- opentelemetry-sdk
- opentelemetry-semconv
- opentelemetry-extension-annotations
- opentelemetry-sdk-extension-autoconfigure

## Main Components

### OtelTracer

The `OtelTracer` class is the main entry point for creating spans. It provides methods to:

- Create spans with different configurations
- Specify parent context
- Link to other spans
- Define span types

### OtelSpan

The `OtelSpan` class wraps an OpenTelemetry Span and provides methods to:

- Set span attributes
- Record exceptions
- Set span status
- Add and retrieve baggage items
- End spans

### GXSpanContext and GXTraceContext

These classes provide wrappers around OpenTelemetry's SpanContext and Context objects, making it easier to handle trace propagation between services.

## Configuration

The module can be configured using environment variables:

- `OTEL_SERVICE_NAME`: Defines the service name for traces
- `OTEL_SERVICE_VERSION`: Defines the service version
- `OTEL_RESOURCE_ATTRIBUTES`: Defines additional resource attributes
- `JAVA_INSTRUMENTATION_SCOPE_NAME`: Override for the instrumentation scope name
- `JAVA_INSTRUMENTATION_SCOPE_VERSION`: Override for the instrumentation scope version

## Usage Examples

### Creating a Simple Span

```java
OtelTracer tracer = new OtelTracer();
OtelSpan span = tracer.createSpan("MyOperation");
try {
    // Perform your operation here
    span.setStringAttribute("attribute.key", "value");
} catch (Exception e) {
    span.recordException(e.getMessage());
    span.setStatus((byte)2, "Operation failed"); // Set status to ERROR
} finally {
    span.endSpan();
}
```

### Creating a Span with Context Propagation

```java
OtelTracer tracer = new OtelTracer();
OtelSpan parentSpan = tracer.createSpan("ParentOperation");
GXTraceContext context = parentSpan.getGXTraceContext();

// Use the context in a child operation
OtelSpan childSpan = tracer.createSpan("ChildOperation", context, (byte)2); // CLIENT span
childSpan.setStringAttribute("request.id", "12345");
childSpan.endSpan();

parentSpan.endSpan();
```

## Integration with GeneXus

This module is designed to be easily integrated with GeneXus applications, providing tracing capabilities that can be used both in Java-based backend services and in code generated by GeneXus.